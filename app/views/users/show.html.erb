<div class="ui container text">
  <div class="ui grid">
    <div class="two column row">
      <div class="column">
        <h1 class="header">
          <% if @user.first_name %>
          <%=@user.name%>
          <% else %>
          <%=@user.email%>
          <% end %>
        </h1>
        <div class="ui grid">
          <div class="two column row">
            <div class="column">
              <h4 class="header">
                Followers: <%= @user.followers.count %>
              </h4>
            </div>
            <div class="column">
              <h4 class="header">
                Following: <%= @user.following.count %>
              </h4>
            </div>
          </div>
        </div>
        <% if @user.id == current_user.id %>
        <%=link_to "Edit Profile", edit_user_path(@user.id), class: 'ui teal button', style:"margin-top:1em;margin-bottom:1em;"%>
        <%=link_to "Add Project", new_user_project_path(@user.id), class: 'ui teal button', style:"margin-top:1em;margin-bottom:1em;"%>
        <% else %>
          <% if current_user.following?(@user) %>
            <%=link_to "Unfollow", user_unfollow_path(@user.id), method: 'delete', class: 'ui teal button', style:"margin-top:1em;margin-bottom:1em;"%>
          <% else %>
            <%=link_to "Follow", user_follow_path(@user.id), method: 'post', class: 'ui teal button', style:"margin-top:1em;margin-bottom:1em;"%>
          <% end %>
        <% end %>
        <p><%=@user.location%></p>
        <p><%=@user.about%></p>
      </div>
      <div class="column">
        <%=image_tag(@user.avatar_url, class: 'ui right floated small circular image')%>
      </div>
    </div>
  </div>
</div>
<div class="ui container text" style="margin-top:1em;">
  <% if @user.id == current_user.id %>
    <% if @user.projects.present? %>
    <div class="ui icon fluid input">
      <input type="text" placeholder="Search for Project..">
      <i class="search icon"></i>
    </div>
    <div class="ui middle aligned very relaxed divided list">
      <% @user.projects.each do |project| %>
        <div class="item">
          <% if current_user.id == @user.id %>
          <div class="content right floated">
            <div class="ui dropdown">
              <i class="ellipsis vertical floated right grey icon"></i>
              <div class="menu">
                <%=link_to "Edit Project", edit_user_project_path(@user.id, project.id), class: 'item'%>
                <%=link_to "Delete Project", user_project_path(@user.id, project.id), method: 'delete', class:'item', data: {confirm: 'Are you sure you want to delete this project?'}%>
              </div>
            </div>
          </div>
          <% end %>
          <% if project.photo_url.present? %>
          <%=image_tag(project.photo_url, class: 'ui image avatar')%>
          <% else %>
          <i class="images large middle aligned grey icon"></i>
          <% end %>
          <div class="content">
            <a class="header"><%=project.title%></a>
            <% if project.description.present? %>
              <div class="description"><%= sanitize project.description%></div>
            <% else %>
              <div class="description">No project description.</div>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
    <% else %>
    <div class="ui placeholder segment">
      <div class="ui icon header">
        <i class="plus grey icon"></i>
        You have no projects. Create one.
      </div>
      <%=link_to "Create a Project", new_user_project_path(@user.id), class:'ui teal button'%>
    </div>
    <% end %>
  <% else %>
    <% if @user.projects.present? %>
    <% else %>
    <h4 class="ui header">This user has no projects.</h4>
    <% end %>
  <% end %>
</div>
<script>
$('.ui.dropdown')
  .dropdown()
;
</script>
